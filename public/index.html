<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AstraFX · analyzer</title>
  <style>
    :root{
      --fg:#f4f6fb; --muted:#ccd2e2; --accent:#2f63ff;
      --panel:rgba(14,18,34,.65); --border:rgba(255,255,255,.12);
      --shadow:0 20px 60px rgba(0,0,0,.38);
      --video-border-w: 12px; /* keep the increased thickness */
    }
    html,body{height:100%; margin:0; font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial; color:var(--fg); background:#0b0f1c;}
    *{box-sizing:border-box}

    /* ===== Robust full-screen background video ===== */
    .bg{position:fixed; inset:0; z-index:0; overflow:hidden;}
    .bg video{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; filter:contrast(1.05) saturate(1.05);}
    .overlay{position:fixed; inset:0; z-index:1; pointer-events:none;
      background:linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.52));}

    /* ===== content wrapper ===== */
    .wrap{position:relative; z-index:2; max-width:1500px; margin:auto; padding:22px; display:flex; flex-direction:column; gap:28px; min-height:100vh;}

    /* brand row */
    .topNav{margin-left:auto; display:flex; gap:10px; align-items:center}
    .navBtn{appearance:none; border:1px solid var(--border); background:rgba(255,255,255,.08); color:var(--fg); padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; text-decoration:none}
    .navBtn:hover{background:rgba(255,255,255,.12)}
    .navBtn.primary{background:var(--accent); border-color:transparent}

    .brandRow{display:flex; gap:16px; align-items:flex-end; justify-content:flex-start; margin-top:8vh;}
    .logo{height:110px; width:auto; display:block;}
    .pill{background:rgba(46,99,255,.92); color:#fff; font-weight:700; font-size:14px; line-height:1; padding:8px 16px; border-radius:999px; border:1px solid rgba(255,255,255,.35); transform:translateY(6px); box-shadow:0 8px 26px rgba(0,0,0,.35);}

    /* ===== Feature video area (with the increased white border) ===== */
    .embed{width:min(98vw, 1500px); margin:0 auto; background:transparent; border:none; padding:0; box-shadow:none;}
    .featureWrap{
      position:relative; width:min(98vw, 1400px); aspect-ratio:16/9; margin:0 auto; border-radius:12px; overflow:hidden; background:#000;
      border: var(--video-border-w) solid #ffffff;  /* keep the thicker border */
    }
    .featureVideo{position:absolute; inset:0; width:100%; height:100%; object-fit:contain; background:#000;}
    .fvOverlay{position:absolute; inset:0; display:grid; place-items:center; pointer-events:none;}
    .fvOverlay[hidden]{display:none;}
    .fvOverlay button{pointer-events:auto; width:112px; height:112px; border-radius:9999px; border:2px solid rgba(255,255,255,.55); background:rgba(0,0,0,.38); color:#fff; font-size:44px; line-height:1; cursor:pointer; backdrop-filter:blur(2px); box-shadow:0 10px 30px rgba(0,0,0,.35);}

    /* ===== informational & account sections ===== */
    .card{width:min(95vw, 980px); margin:0 auto; background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:18px 16px; box-shadow:var(--shadow); backdrop-filter:saturate(1.05) blur(1.5px);}
    .card.narrow{width:min(95vw, 480px);}
    h2{margin:0 0 8px 0; font-weight:800; letter-spacing:.2px;}
    p{margin:0; color:var(--muted)}

    .account{display:flex; flex-direction:column; gap:12px}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-start}
    .row input{flex:1 1 240px; min-width:220px; background:rgba(255,255,255,.06); color:var(--fg); border:1px solid var(--border); border-radius:10px; padding:10px 12px; outline:none;}
    .row button{background:var(--accent); color:#fff; font-weight:800; border:0; border-radius:10px; padding:10px 16px; cursor:pointer; box-shadow:0 6px 22px rgba(47,99,255,.32);}
    .row button.ghost{background:rgba(255,255,255,.08); color:var(--fg); border:1px solid var(--border);}
    .hint{font-size:13px; color:var(--muted)}

    /* privacy = only as wide as the text, centered */
    .privacy{width:max-content; max-width:95vw; margin:0 auto; background:var(--panel); border:1px solid var(--border); border-radius:999px; padding:10px 16px; box-shadow:var(--shadow); text-align:center;}

    @media (max-width:900px){
      .logo{height:86px}
      .pill{font-size:13px; padding:7px 14px}
      .featureWrap{width:min(98vw, 1100px);}
    }
  </style>
</head>
<body>

  <!-- ===== Background video (original) ===== -->
  <div class="bg">
    <video id="bgVideo" autoplay muted loop playsinline webkit-playsinline preload="metadata" poster="/assets/landing_poster.jpg">
      <source src="/assets/landing.mp4" type="video/mp4" />
    </video>
  </div>
  <div class="overlay" aria-hidden="true"></div>

  <!-- ===== Content ===== -->
  <div class="wrap">

    <!-- Brand -->
    <div class="brandRow">
      <img class="logo" src="/assets/logo.png" alt="AstraFX logo" />
      <div class="pill">analyzer</div>
  </div>

    <!-- Feature area (new video INSIDE; full frame visible; thicker white border) -->
    <section class="embed" aria-label="Featured video">
      <div class="featureWrap">
        <video id="featureVideo" class="featureVideo" controls preload="metadata" poster="/assets/2landing_poster.jpg">
          <source src="/assets/landing_hero.mp4" type="video/mp4" />
          Sorry, your browser doesn’t support HTML5 video.
        </video>
        <div id="fvOverlay" class="fvOverlay">
          <button type="button" aria-label="Play video">▶</button>
        </div>
      </div>
    </section>

    <!-- What is AstraFX? -->
    <section class="card">
      <h2>What is AstraFX?</h2>
      <p>Scan multiple pairs and time frames for strategy setups. The scan will be completed on the major currency pairs and gold. (EUR/USD, GBP/USD, USD/JPY, AUD/USD, USD/CAD, USD/CHF, NZD/USD, XAU/USD)</p>
    </section>

    <!-- Create account / Login -->
    <section class="card narrow">
      <h2>Create account / Login</h2>
      <div class="account">
        <div class="row">
          <input id="email" type="email" placeholder="Email address" autocomplete="email" />
          <input id="pass" type="password" placeholder="Password" autocomplete="new-password" />
        </div>
        <div class="row">
          <button id="createBtn" type="button">Create account</button>
          <button id="loginBtn" type="button" class="ghost">Login</button>
        </div>
        <div id="msg" class="hint" style="margin-top:4px;"></div>
      </div>
    </section>

    <!-- Privacy -->
    <div class="privacy">Your email will never be given out or sold to any third parties and will only be used for this website.</div>

  </div>

  <!-- ===== Scripts ===== -->
  <script>
    // Feature video overlay play (inside the placeholder) — with sound, not autoplay
    (function () {
      const v = document.getElementById('featureVideo');
      const ov = document.getElementById('fvOverlay');
      const btn = ov ? ov.querySelector('button') : null;
      function hide(){ ov && ov.setAttribute('hidden',''); }
      function show(){ ov && ov.removeAttribute('hidden'); }
      show();
      v.addEventListener('play', hide);
      v.addEventListener('pause', show);
      if (btn) btn.addEventListener('click', () => { v.play().catch(()=>{}); });
      if (!v.paused) hide();
    })();

    // Helpers
    const $ = (id) => document.getElementById(id);
    async function postJSON(url, data){
      try {
        const res = await fetch(url, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data)});
        const js = await res.json().catch(()=>({}));
        return {ok: res.ok, status: res.status, json: js};
      } catch (e) {
        return {ok:false, status:0, json:{detail:'network error'}};
      }
    }

    // API flow with fallback auth AND show email/password + note after signup
    (function(){
      const msg = $('msg');
      $('createBtn').addEventListener('click', async () => {
        const email = $('email').value.trim();
        const password = $('pass').value.trim();
        if(!email || !password){ msg.textContent = 'Please enter email and password.'; return; }
        const r = await postJSON('/api/signup', {email, password});
        if(r.ok){
          msg.innerHTML = 'Email: ' + email + '<br>Password: ' + password + '<br>please write down your passowrd.';
        } else {
          try {
            const users = JSON.parse(localStorage.getItem('astrafxUsers')||'{}'); users[email]=password;
            localStorage.setItem('astrafxUsers', JSON.stringify(users));
            msg.innerHTML = 'Email: ' + email + '<br>Password: ' + password + '<br>please write down your passowrd.';
          } catch {}
        }
      });

      function setAuthKeys(email){
        try {
          localStorage.setItem('astrafxAuth','1');
          sessionStorage.setItem('astrafxAuth','1');
          localStorage.setItem('astrafxUser', email);
          sessionStorage.setItem('astrafxUser', email);
          document.cookie = 'astrafx_auth=1; path=/; max-age=31536000; SameSite=Lax';
          document.cookie = 'astrafx_user=' + encodeURIComponent(email) + '; path=/; max-age=31536000; SameSite=Lax';
        } catch {}
      }

      $('loginBtn').addEventListener('click', async () => {
        const email = $('email').value.trim();
        const password = $('pass').value.trim();
        if(!email || !password){ msg.textContent = 'Please enter email and password.'; return; }
        const r = await postJSON('/api/login', {email, password});
        if(r.ok){
          setAuthKeys(email);
          window.location.href = '/app/';
        } else {
          try {
            const users = JSON.parse(localStorage.getItem('astrafxUsers')||'{}');
            if(users[email] && users[email] === password){
              setAuthKeys(email);
              window.location.href = '/app/';
              return;
            }
          } catch {}
          msg.textContent = r.json.detail || 'Login failed.';
        }
      });
    })();
  </script>
</body>
</html>
