<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AstraFX â€” Landing</title>
  <style>
    :root{
      --bg-dark: #0a0f1a;
      --text: #e6eefc;
      --muted: #9fb2d0;
      --accent: #4aa3ff;
      --accent-dark: #2a7ad9;
      --card: #11182a;
      --card-2: #0e1526;
      --shadow: rgba(0,0,0,.45);
      --pill: #0c203b;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg-dark);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .bg-wrap{position:fixed;inset:0;overflow:hidden;z-index:-1}
    .bg-wrap video{position:absolute;top:50%;left:50%;min-width:100%;min-height:100%;transform:translate(-50%,-50%);filter:brightness(.4)}
    .backdrop{position:fixed;inset:0;background:radial-gradient(ellipse at center, rgba(0,0,0,.25) 0%, rgba(0,0,0,.5) 55%, rgba(0,0,0,.65) 100%);z-index:-1}
    .container{max-width:1100px;margin:0 auto;padding:28px 16px 48px}
    .brand-row{display:flex;align-items:flex-end;gap:14px;margin:18px 0 14px 4px}
    .brand-logo{height:48px;object-fit:contain}
    .brand-pill{background:var(--pill);border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px;font-size:12px;letter-spacing:.2px;translate:0 8px}
    .video-shell{background:linear-gradient(180deg,var(--card-2),var(--card));border:1px solid rgba(255,255,255,.08);
      border-radius:18px;box-shadow:0 10px 30px var(--shadow);padding:10px;margin:4px auto 22px}
    .video-box{position:relative;aspect-ratio:16/9;width:100%;max-width:980px;margin:0 auto;border-radius:12px;overflow:hidden;background:#0003}
    .video-box .placeholder{position:absolute;inset:0;display:grid;place-items:center;border:2px dashed rgba(255,255,255,.18);border-radius:12px}
    .video-box .placeholder span{opacity:.9;color:var(--muted)}
    .block{background:linear-gradient(180deg,var(--card-2),var(--card));border:1px solid rgba(255,255,255,.08);
      border-radius:16px;padding:18px 16px;margin:16px auto;box-shadow:0 10px 24px var(--shadow);max-width:980px}
    .block h2{margin:0 0 8px;font-weight:650;letter-spacing:.2px}
    .muted{color:var(--muted)}
    .auth{max-width:520px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .input{flex:1 1 220px;background:#0a1324;border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:10px 12px;color:var(--text);outline:none}
    .btn{background:var(--accent);border:none;color:white;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer}
    .btn:hover{background:var(--accent-dark)}
    .msg{margin-top:8px;font-size:13px;min-height:18px}
    .privacy{display:inline-block;max-width:none;width:auto;margin:0 auto}
    .privacy p{margin:0}
    .denied{display:none;max-width:980px;margin:0 auto 12px;background:#2b1120;color:#ffd9e1;border:1px solid #f08; padding:10px 12px;border-radius:12px}
    .denied.show{display:block}
  </style>
</head>
<body>
  <div class="bg-wrap"><video src="/assets/landing.mp4" autoplay muted loop playsinline></video></div>
  <div class="backdrop"></div>

  <div class="container">
    <div class="brand-row">
      <img src="/assets/logo.png" alt="AstraFX" class="brand-logo" />
      <div class="brand-pill">analyzer</div>
    </div>

    <div id="denied" class="denied">Please login or create an account to access the app.</div>

    <div class="video-shell">
      <div class="video-box">
        <div class="placeholder"><span>Video placeholder (embed coming soon)</span></div>
      </div>
    </div>

    <section class="block">
      <h2>What is AstraFX?</h2>
      <p class="muted">Scan multiple pairs and time frames for strategy setups. The scan will be completed on the major currency pairs and gold. (EUR/USD, GBP/USD, USD/JPY, AUD/USD, USD/CAD, USD/CHF, NZD/USD, XAU/USD)</p>
    </section>

    <section class="block auth">
      <h2>Create account / Login</h2>
      <p class="muted">Sign up to get access and updates. Then login to continue to the app.</p>
      <div class="row">
        <input id="email" class="input" type="email" placeholder="Email" autocomplete="email">
        <input id="password" class="input" type="password" placeholder="Password (min 6 chars)" autocomplete="new-password">
      </div>
      <div class="row" style="margin-top:8px">
        <button id="signupBtn" class="btn">Create account</button>
        <button id="loginBtn"  class="btn" style="background:#00b27a">Login</button>
      </div>
      <div id="msg" class="msg"></div>
    </section>

    <section class="block privacy">
      <p class="muted">Your email will never be given out or sold to any third parties and will only be used for this website.</p>
    </section>
  </div>

  <script>
    const url = new URL(window.location.href);
    if (url.searchParams.get('denied') === '1') {
      document.getElementById('denied').classList.add('show');
    }
    const $ = (id) => document.getElementById(id);
    async function postJSON(url, data){
      const res = await fetch(url, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data)});
      let js = {}; try { js = await res.json(); } catch {}
      return {ok: res.ok, status: res.status, json: js};
    }
    document.getElementById('signupBtn').addEventListener('click', async () => {
      const email = $('email').value.trim();
      const password = $('password').value.trim();
      if(!email || !password){ $('msg').textContent = 'Enter email and password.'; return; }
      const {ok, json} = await postJSON('/api/signup', {email, password});
      if(ok){
        alert(`Account created for: ${email}\nPassword: ${password}\n\nPlease write this combination down.`);
        $('msg').textContent = 'Account created. Now click Login to continue.';
        $('msg').style.color = '#9fe6c3';
      }else{
        $('msg').textContent = json.detail || 'Signup failed.';
        $('msg').style.color = '#f6a8a8';
      }
    });
    document.getElementById('loginBtn').addEventListener('click', async () => {
      const email = $('email').value.trim();
      const password = $('password').value.trim();
      if(!email || !password){ $('msg').textContent = 'Enter email and password.'; return; }
      const {ok, json} = await postJSON('/api/login', {email, password});
      if(ok){ window.location.href = '/app/'; }
      else { $('msg').textContent = json.detail || 'Login failed.'; $('msg').style.color = '#f6a8a8'; }
    });
  </script>
</body>
</html>
